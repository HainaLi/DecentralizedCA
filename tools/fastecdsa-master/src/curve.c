#include "curve.h"
#include <stdlib.h>

CurveZZ_p * buildCurveZZ_p(char * p, char * a, char * b, char * q, char * gx, char * gy, int base) {
    CurveZZ_p * curve = (CurveZZ_p *)malloc(sizeof(CurveZZ_p));
    mpz_init_set_str(curve->p, p, base);
    mpz_init_set_str(curve->a, a, base);
    mpz_init_set_str(curve->b, b, base);
    mpz_init_set_str(curve->q, q, base);
    curve->g = buildPointZZ_p(gx, gy, base);
    return curve;
}

void destroyCurveZZ_p(CurveZZ_p * curve) {
    mpz_clears(curve->p, curve->a, curve->b, curve->q, NULL);
    destroyPointZZ_p(curve->g);
    free(curve);
}

CurveZZ_p * buildP192() {
    return buildCurveZZ_p(
        "6277101735386680763835789423207666416083908700390324961279",
        "-3",
        "2455155546008943817740293915197451784769108058161191238065",
        "6277101735386680763835789423176059013767194773182842284081",
        "602046282375688656758213480587526111916698976636884684818",
        "174050332293622031404857552280219410364023488927386650641",
        10
    );
}

CurveZZ_p * buildP224() {
    return buildCurveZZ_p(
        "26959946667150639794667015087019630673557916260026308143510066298881",
        "-3",
        "18958286285566608000408668544493926415504680968679321075787234672564",
        "26959946667150639794667015087019625940457807714424391721682722368061",
        "19277929113566293071110308034699488026831934219452440156649784352033",
        "19926808758034470970197974370888749184205991990603949537637343198772",
        10
    );
}

CurveZZ_p * buildP256() {
    return buildCurveZZ_p(
        "115792089210356248762697446949407573530086143415290314195533631308867097853951",
        "-3",
        "41058363725152142129326129780047268409114441015993725554835256314039467401291",
        "115792089210356248762697446949407573529996955224135760342422259061068512044369",
        "48439561293906451759052585252797914202762949526041747995844080717082404635286",
        "36134250956749795798585127919587881956611106672985015071877198253568414405109",
        10
    );
}

CurveZZ_p * buildP384() {
    return buildCurveZZ_p(
        "39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319",
        "-3",
        "27580193559959705877849011840389048093056905856361568521428707301988689241309860865136260764883745107765439761230575",
        "39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643",
        "26247035095799689268623156744566981891852923491109213387815615900925518854738050089022388053975719786650872476732087",
        "8325710961489029985546751289520108179287853048861315594709205902480503199884419224438643760392947333078086511627871",
        10
    );
}

CurveZZ_p * buildP521() {
    return buildCurveZZ_p(
        "6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151",
        "-3",
        "1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984",
        "6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449",
        "2661740802050217063228768716723360960729859168756973147706671368418802944996427808491545080627771902352094241225065558662157113545570916814161637315895999846",
        "3757180025770020463545507224491183603594455134769762486694567779615544477440556316691234405012945539562144444537289428522585666729196580810124344277578376784",
        10
    );
}

CurveZZ_p * buildSecp256k1() {
    return buildCurveZZ_p(
        "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F",
        "0",
        "7",
        "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141",
        "79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798",
        "483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",
        16
    );
}

CurveZZ_p * buildSecp192k1() {
    return buildCurveZZ_p(
        "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37",
        "0",
        "3",
        "FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D",
        "DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D",
        "9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",
        16
    );
}